---
title:  "【文献阅读】Map-Matching for Low-Sampling-Rate GPS Trajectories（低采样率下GPS轨迹的地图匹配）"
date:   2021-12-09 11:30:00 +0800
key: Map-Matching_for_Low-Sampling-Rate_GPS_Trajectories
categories: 文献阅读
tag: "Map Matching"
---
# 引言

笔者近期需要寻找地图匹配落地的相关算法，用于道路轨迹拟合。近十年提出的算法中，基于隐马尔可夫（HMM）模型的算法是主流，其次是基于最大权重的模型。我调研选用了开源的三种算法：LMM、FMM、STMM。
![](https://zdd-1300938198.cos.ap-beijing.myqcloud.com//my-picture-bed/20220722114620.png)

这篇论文提出了基于最大权重的地图匹配算法：STMM。以所有采样点的候选点为顶点集，相邻采样点的候选点间的联系为边集构成有向无环图，搜索权重最大的轨迹序列。

这里只是翻译了一下论文中的STMM创新点，并未对技术细节详细分析。

# Abstract

地图匹配是将观测到的用户位置序列与数字地图上的道路网络对齐的过程。它是许多应用程序的基本预处理步骤，如移动对象管理、交通流分析和行驶方向。在实践中，存在大量的低采样率（例如，每2-5分钟一个点）GPS轨迹。不幸的是，**当前大多数地图匹配方法仅处理高采样率（通常每10-30秒一个点）GPS数据，并且随着数据不确定性的增加，对低采样率点的效果会降低** 。

在本文中，我们为低采样率GPS轨迹提出了一种新的全局地图匹配算法ST-Matching。ST-Matching考虑以下两点：（1）道路网络的空间几何和拓扑结构以及（2）轨迹的时间/速度约束。

基于时空分析，构造一个候选图，从中识别出最佳匹配路径序列。

我们将ST-Matching与增量算法和基于平均Fréchet距离（AFD）的全局地图匹配算法进行了比较。实验在合成数据集和真实数据集上进行。结果表明，对于低采样轨迹，我们的ST匹配算法在匹配精度方面明显优于增量算法。同时，与基于AFD的全局算法相比，ST匹配也提高了精度和运行时间。

# Introduction

在过去几年中，手持或仪表板上安装的旅行指导系统、GPS嵌入式PDA和智能手机急剧增加。这些设备的普及使得人们能够收集到大量的GPS轨迹。越来越多的应用程序，如路线规划器[7]、热门路线查找器[16]、交通流分析[15]、地理社交网络[23]，已经开始使用GPS数据中的信息来实现更好的服务质量。

通常，GPS轨迹由一系列具有纬度、经度和时间戳信息的点组成。然而，由于GPS设备的限制造成的测量误差和采样率造成的采样误差，该数据并不精确[17]。因此，观测到的GPS位置通常需要与给定数字地图上的道路网对齐。这个过程称为地图匹配。地图匹配是许多基于轨迹的应用程序（如移动对象管理、交通流分析和行驶方向）的基本预处理步骤。地图匹配的难度可能因GPS精度和采样率的不同而大不相同。

本文着重讨论了**采样误差**问题。在实践中，存在大量低采样率（例如，每2分钟一个点）的GPS轨迹。它们要么是从特定的基于位置的查询中收集的应用程序日志数据，要么是在需要节约能源成本和通信成本的场景中生成的数据。例如，北京有60000多辆出租车，其中许多是嵌入GPS的。由于出租车司机出行非常频繁，因此必须降低采样率，以节省能源消耗并实现合理的响应时间。不幸的是，当前的地图匹配方法只处理高采样率（通常每10-30秒一个点）GPS数据，并且随着数据不确定性的增加，对低采样率点的效果会降低。

大多数现有的地图匹配方法采用局部或增量算法，将当前或相邻位置映射到地图上的矢量道路段上。对于只考虑当前位置的方法，测量误差对结果影响很大。由于完全忽略了相邻点的相关性，因此精度通常较低。[8][7]中的增量匹配算法追求轨迹一小部分的局部匹配。在匹配新位置时，将考虑其先前位置和最后匹配的边。尽管计算速度很快，但该方法的性能对采样频率的降低很敏感。

另一方面，全局算法将整个轨迹与道路网络对齐。一般来说，全局方法以更高的计算成本获得更好的精度。现有全局匹配算法都基于特定的距离/相似性度量（如[3]中提出的平均Fréchet距离）。缺乏地面真实性（即运动对象的“真实”路径）使得难以评估真实匹配质量。此外，现有的全局匹配算法仅采用空间分析，而忽略了轨迹的时间/速度约束。这使得它们也容易受到采样率下降的影响。

在本文中，我们将**低采样率称为每2分钟或以上一个点**。使用这种采样率，即使车辆速度仅为40km/h，两点之间的距离也可能超过1300m！这对地图匹配问题提出了很大的挑战，因为随着两个相邻点之间距离的增加，可以用来推断对象精确位置的信息会减少。当一个运动物体高速运动，或者两个观测到的相邻点之间有许多交叉点时，问题会加剧。

为了应对这一挑战，我们提供了两个关键的观察结果，这两个观察结果导致了我们的方法，如以下示例所示。

**观察1：真正的路径往往是直接的，而不是迂回的。**

考虑图1中显示的出租车GPS轨迹。出租车从北向南行驶。大多数地图匹配算法将匹配圆形GPS观测点Pb到最近的路段，即垂直的路段。然而从它前后的点Pa和Pc中，我们认为Pb应与水平路段相匹配，因为该出租车不太可能先绕到水平道路，然后再返回垂直道路。这意味着可以将道路网络的拓扑信息与位置上下文相结合，以提供更好的匹配结果。

![](https://zdd-1300938198.cos.ap-beijing.myqcloud.com//my-picture-bed/20220722113419.png)

**观察2：真实路径往往遵循道路的速度限制。**

考虑图2中显示的另一个滑行GPS轨迹。如果没有速度信息，几乎不可能判断这两个点是属于公路还是服务道路。

![](https://zdd-1300938198.cos.ap-beijing.myqcloud.com//my-picture-bed/20220722113728.png)

基于此，本文做出以下贡献：
- 我们提出了一种新的全局匹配算法，称为STmatching，用于低采样率GPS轨迹。它结合了以前方法未探索的空间和时间特征。
- 我们在合成数据集和真实数据集上进行了大量实验。真实的数据集是从物理世界收集的，并由真实的人标记。因此，与大多数现有工作中使用的合成数据相比，它可以更好地评估地图匹配算法的性能。
- 我们的算法在运行时间和匹配精度方面进行了评估。结果表明，在低采样率轨迹的匹配精度方面，我们的ST匹配算法明显优于增量算法。同时，与基于平均FRéchet距离的全局算法相比，ST匹配也提高了准确性和运行时间。

# 参考文献

[1] 于娟,杨琼,鲁剑锋,韩建民,彭浩.高级地图匹配算法：研究现状和趋势[J].电子学报,2021,49(09):1818-1829.
[2] Lou Y, Zhang C, Zheng Y, et al. Map-matching for low-sampling-rate GPS trajectories[C] //Proceedings of the 17th ACM SIGSPATIAL international conference on advances in geographic information systems. 2009: 352-361.