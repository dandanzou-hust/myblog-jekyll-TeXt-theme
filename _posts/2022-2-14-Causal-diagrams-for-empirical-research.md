---
title:  "【文献阅读】Causal diagrams for empirical research"
date:   2022-2-14 12:00:00 +0800
key: Causal-diagrams-for-empirical-research
categories: 文献阅读
tag: "因果推理"
---
# 序

这篇文章是 [Judea Pearl](http://bayes.cs.ucla.edu/jp_home.html) 于 1995 年发表在 Biometrika 上的工作。

属于因果图的开山之作，数学上详细证明了使用图模型可以实现因果推理。

# 摘要

本文主要目的是展示如何使用图模型作为一个数学语言来用于整合统计信息和主题信息。

- 本文提出了一个规则性的、非参数的因果推理框架。在该框架下，查询图表以确定可用的假设是否足以从非实验数据中识别偶然效应。
- 如果是这样的话，可以查询图表，根据观察到的分布生成因果效应的数学表达式。
- 否则，这些图表可以被查询，以建议额外的观察或辅助实验，从中可以得到所需的推论。

# 1 介绍

本文介绍的工具目的在于帮助研究者传达关于因果关系的定性假设，阐明假设的分歧，从一系列假设、实验、数据中得出因果推理。

以一个例子演示：用土壤熏蒸剂 X 来控制 鳗虫种群 Z，以增加燕麦产量 Y。但除了控制鳗虫之外，还可能对产量产生直接影响（有利或不利的）。

我们希望评价X对整体的影响：

- 首先，我们假定控制随机实验是不可行的。因为，农民们坚持自己对土地施肥，并且仅同意研究者非损伤性的测试。
- 我们假定农民们对治疗方法的选择取决于去年鳗虫的数量 Z0。一个未知量，去年的鳗虫流行程度强相关于今年流行程度。因此我们有了一个经典的混杂偏倚，干扰了治疗效果的评估，无论样本大小。
- 幸运的是，从土壤样本的实验室分析，我们可以分析治疗前后的鳗虫种群。此外，因为熏蒸剂有效时间非常短，我们可以安全的假定他们并不影响在治疗中幸存下来的鳗蛔虫的生长。
- 然而，在使用熏蒸剂之后，鳗虫的存活取决于鸟类（和其他捕食者）的数量，而鸟类（和其他捕食者）的数量又与去年的鳗虫数量以及治疗本身有关。

本文提出的方法允许调查员翻译这类复杂的考虑为公式语言，因此促进了下面的任务：

- 解释模型背后的假设
- 决定是否假设足以获得对目标数量的一致估计：熏蒸剂对土地的总体影响。
- 如果第二条的答案是肯定的，该方法根据观测量的分布，为目标量提供了一个封闭形式的表达式。
- 如果第二条的答案是否定的，该方法提出了一系列观测和实验，这将使一致的估计变得可行。

具体方案：

- 第一步，构造一个因果图。

Z1 Z2 Z3分别代表鳗虫在治疗前、后和季节结束的流行程度。

Z0 代表去年鳗虫的流行程度。因为这是一个未知量，由一个空心圆B表示，代表鸟和其他捕食者的数量。

图中的连接有两种：用虚线箭头表示无法测量的量连接。用实心箭头表示可测量的量连接。

**图表中包含的实质性假设是通过图表中缺失的链接传达的消极因果断言。**

例如，Z1和Y缺失箭头证实了研究员的理解：治疗前的鳗虫流行程度不能直接影响燕麦片。他们对燕麦土地完整的影响是由Z2、Z3间接促成的。这篇文章的目的不是验证或者否认这样的特定领域假设，而是测试对于从非实验数据中量化因果影响，给定一系列假设是否有效。例如，评估鳗虫对于农田的总体影响。

![image-20220218174042836](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220218174042836.png)

因果图在许多方面都相似于由Wright提出的path diagrams：两者都反应了研究员的在该领域内的因果影响的主观性和定性的知识，都采用了有向无环图，都考虑并入了潜在的或未测量的量。主要差别在于分析方法不同：

1. 与path diagrams 大多应用在加性线性模型中不同的是，因果图允许任意的非线性相互作用。事实上因果效应的分析是完全无参数的，不包含对交互和分布的特定功能形式的承诺。
2. 因果图不仅仅是被用作一种消极的语言来具体说明假设，还是一个积极的计算设备，通过它可以导出所需的量。

例如，提出的方法允许研究者检查图一并且立即总结出以下几点：

1. X对Y的总体影响可以由X、Z1、Z2、Z3和Y的观测分布来评估。
2. X对Y的总体影响（假设为离散变量）可以由下式给出：

![image-20220221144906182](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220221144906182.png)

​		上式代表通过外部干涉将治疗设置为 X=x，取得 Y=y 的概率。

3. 如果Y和Z3是混淆的，X对Y的总体影响的一致性估计是不可行的。然而，混淆Z2和Y不会使上式无效。

这些结论可通过分析图的图形属性或者通过执行一系列由图表控制的符号导数来获得，产生了因果效应公式一。



后续章节概述：

- 第二部分定义了文章中的因果图的形式语义
  - 2.1使用有向无环图DAGs讨论条件独立假设。
  - 2.2基于无参数的结构方程介绍了一个DAGs的因果解释，展示他们用于预测干预对结果的影响。**然后描述了另一个公式，其中干预被视为增广概率空间（由因果图形成）中的变量，通过普通条件作用从中获得因果效应。**使用任一干预，都可以量化概率分布如何由外部干预改变的，并且确定无需进行随机实验的条件。
- 第三部分演示了在观测的研究中使用因果图来控制混淆偏置。我们建立两个图条件来确保因果效应可以被无实验数据来一致性估计。第一个条件，叫后门准则，等价于强可忽略的处理分配条件（Rosenbaum & Rubin，1983）。第二个条件，叫后门准则，涉及受治疗影响的协变量，因此为因果推理提供了新的机会。
- 第四部分我们介绍了一个符号化的微积分，允许公式一中因果效应公式逐步求导。微积分使用了三个推理规则，每个规则的适用性都取决于图的拓扑结构。
- 第五部分总结了来自无实验数据或者替代实验设计的允许量化因果效应的图的类型。

# 2 图模型和可操纵的因果关系

## 2.1 图和条件概率

该部分简要回顾了DAGs作为条件独立信息载体的特性。读者熟悉这部分可以跳至2.2部分。

文中的图是指有向无环图DAGs，定义如下：

1. 作为表示条件独立性假设的经济方案
2. 作为表示定性因果效应的语言

给定一个DAG称为 $$G$$ 和一个离散变量 $$X=\{X_1, ... ,X_n\}$$ 的联合分布 $$P$$，如果 $$X$$ 中的变量和 $$G$$ 中的节点有一一对应关系，我们说 $$G$$ 表示 $$P$$ ，这样 $$P$$ 允许递归积分解：

![image-20220221171929368](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220221171929368.png)

其中 $$pa_i$$ 是 $$G$$中 $$X_i$$ 的直接前任（称为 parents）。公式2中的递归分解表明，设置parent为 $$pa_i$$ ，每个变量 $$X_i$$ 和它其他的前任 $$ \{ X_1, X_2, ..., X_i-1\}\\pa_i$$是条件独立的。使用Dawid的符号[1979]，我们可以阐述这种独立如下：

![image-20220221173507173](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220221173507173.png)

一种图标准称为d-separation [Pearl 1988] 允许我们从DAG中读出给定分解所隐含的所有独立性的总和。

**定义2.1（d-separation）**

$$X$$ , $$Y$$ , $$Z$$ 是有向无环图 $$G$$ 中的三个不相交的节点子集，p是 $$X$$ 中的某一节点和 $$Y$$ 中某一节点的任意路径（我们所说的路径是指任何连续的圆弧，无论其方向如何）。如果在p上的节点w满足以下两个条件中的一个，可以说 w 阻挡p：

1. w有会聚箭头（沿p），并且w及其任何后代都不在$$Z$$中。
2. w没有会聚箭头（沿p），并且w在$$Z$$中。

在 G 中，当且仅当 $$Z$$阻挡了从 $$X$$ 中的节点到 $$Y$$ 中的节点的所有路径,称 $$Z$$ d-隔离（d-separation)了 $$X$$ 和 $$Y$$ ，定义为 ![image-20220221180621367](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220221180621367.png)。

公式2的递归分解表明的独立性集合 和 $$G$$ 中满足d-separation的三元组（$$X$$，$$Z$$，$$Y$$）集合 是一一对应的。[Geiger et al. 1990]

[Geiger et al. 1990] 基于祖先图的概念为d-separation设计了一个备选的测试。从G中删除（除了在$$\{X，Y，Z\}##中节点和他们的祖先）其他所有的节点。通过边连接共享一个公共子节点的每对节点，移除弧线的所有箭头。当且仅当 $$Z$$ 是结果无向图的割集，将 $$X$$ 和 $$Y$$ 的节点分开，则![image-20220221180621367](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220221180621367.png)。DAGs的其他附加性质和专家系统中的证据推理的应用见[Pearl 1988, Lauritzen & Spiegelhalter 1988, Spiegelhalter et al. 1993, Pearl  1993a]。

## 2.2 作为干预模型的图

DAGs作为独立性假设的载体的解释并未特别提及因果关系，DAGs展示这样的假设事实上可以为变量的任何顺序（不一定是因果的或者按时间顺序的）构造。然而，DAGs的主要使用基于了他们描绘因果关系的能力，而不是统计学、关联。因为因果模型（假设他们是正确验证的）提供了行为效果的信息。换句话说，联合分布告诉我们，事件的可能性有多大和后续观测中的概率如何改变。因果模型也告诉我们由外部干预后的概率如何改变，例如在政策分析和治疗管理中遇到的问题。

因果关系和DAGs的联想到一起的想法是由基于机制的因果关系解释而形成的。其根源在于早期的计量经济学著作[Frisch 1938, Haavelmo 1943, Simon 1953]。在这个解释中，关于因果关系影响的推断（例如图一中定义的连接）代表了相应量之间的自治物理机制，这些机制可以表示为受随机扰动的函数关系。换句话说，每个子父关系代表了一个确定性函数：

![image-20220222113305985](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220222113305985.png)

$$pa_i$$是$$G$$中$$X$$的父节点，$$\varepsilon_i$$（0<i<=n）是相互独立的，任意分布随机扰动 [Pearl & Verma 1991]。这些扰动表示独立外部影响因子，研究员们选择不包含在分析中。弱国这些影响因子影响了两个以上变量（违背了独立性假设），那么因子必须作为一个未测量变量（或潜在变量）加入到分析中。在图中表示为空心节点，例如图一中的$$Z_0$$和$$B$$。例如，由图一中模型表示的因果假设对应了如下方程的集合：

![image-20220222114612679](https://gitee.com/ddzou/my-picture-bed-on-gitee/raw/master//markdown-picture//image-20220222114612679.png)

公式4中的等式模型是无参数的，类似于计量经济学中的结构方程模型（SEM）。只有一个例外：等式的函数形式和扰动分布是不一定的。和传统的概率不同，结构方程表达了稳定的反事实信息，因此在因果图和潜在反应Rubin模型[Rubin 1974, Holland 88]形成了一个清晰的对应关系。例如Y的等式表明无论我们当前关注Y的什么，无论任何其他等式中可能发生的变化，如果$$X, Z_2, Z_3, \varepsilon_Y$$假定值为$$x, z_2, z_3, \varepsilon_Y$$,分别的，Y取函数$$$f_Y$$对应的值。





